<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KAWAN BISA - SIDOARJO</title>
    
    <!-- Menggunakan Tailwind CSS untuk styling modern -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Menggunakan Google Fonts untuk tipografi yang bersih -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Menambahkan library Leaflet.js untuk Peta -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <style>
        /* Style kustom untuk aplikasi */
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }
        /* Memberi efek scroll yang halus */
        .smooth-scroll {
            scroll-behavior: smooth;
        }
        /* Kustomisasi scrollbar agar lebih modern */
        .chat-window::-webkit-scrollbar { width: 6px; }
        .chat-window::-webkit-scrollbar-track { background: #f1f5f9; }
        .chat-window::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        .chat-window::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        .tab-icon-active { color: #3b82f6; }
        #map { height: 300px; border-radius: 0.5rem; }
        
        .bot-response ul { list-style-type: disc; margin-left: 20px; margin-top: 8px; }
        .bot-response li { margin-bottom: 4px; }

        /* --- Dark Mode Styles --- */
        .dark {
            background-color: #0f172a; /* slate-900 */
            color: #e2e8f0; /* slate-200 */
        }
        .dark .bg-slate-100 { background-color: #0f172a; }
        .dark .bg-white, .dark .bg-white\/80 {
            background-color: #1e293b; /* slate-800 */
            border-color: #334155; /* slate-700 */
        }
        .dark .text-gray-800, .dark .text-slate-700, .dark .text-gray-700 { color: #e2e8f0; }
        .dark .text-gray-500 { color: #94a3b8; }
        .dark .text-gray-400 { color: #64748b; }
        .dark .shadow-md { box-shadow: 0 4px 6px -1px rgba(0,0,0,0.4), 0 2px 4px -2px rgba(0,0,0,0.4); }
        .dark .shadow-sm { box-shadow: 0 1px 2px 0 rgba(0,0,0,0.3); }
        .dark .bg-slate-200 { background-color: #334155; }
        .dark .hover\:bg-slate-300:hover { background-color: #475569; }
        .dark .border-slate-300 { border-color: #475569; }
        .dark .bg-slate-100 { background-color: #1e293b; }
        .dark .chat-window::-webkit-scrollbar-track { background: #1e293b; }
        .dark .chat-window::-webkit-scrollbar-thumb { background: #475569; }
    </style>
</head>
<body class="bg-slate-100 text-gray-800">

    <!-- Kontainer utama aplikasi, dibuat menyerupai tampilan mobile -->
    <div class="max-w-md mx-auto h-screen flex flex-col bg-slate-100 shadow-2xl">

        <!-- Header Aplikasi -->
        <header class="bg-white/80 backdrop-blur-sm p-4 border-b border-slate-200 z-10">
            <div class="flex justify-between items-center">
                <!-- Logo PSI di Kiri -->
                <div class="w-1/4 flex justify-start">
                    <a href="https://www.instagram.com/dpdpsisidoarjo/" target="_blank" rel="noopener noreferrer" class="transition-transform duration-200 hover:scale-110" title="Kunjungi Instagram PSI Sidoarjo">
                        <!-- PERUBAHAN UKURAN LOGO -->
                        <img src="logo-psi.png" alt="Logo PSI" class="w-12 h-12 rounded-full">
                    </a>
                </div>
                <!-- Tengah: Judul -->
                <div class="w-1/2 text-center">
                    <h1 class="text-xl font-bold bg-gradient-to-r from-blue-500 to-red-500 bg-clip-text text-transparent" data-translate-key="app_title">KAWAN BISA</h1>
                    <p class="text-xs text-gray-500 mt-1" data-translate-key="app_subtitle">Kolaborasi PSI DPD SIDOARJO X BNN SIDOARJO</p>
                    <p id="datetime" class="text-[10px] text-gray-400 mt-1"></p>
                </div>
                <!-- Logo BNN & Pengaturan di Kanan -->
                <div class="w-1/4 flex justify-end items-center gap-4">
                     <a href="https://www.instagram.com/infobnn_kab_sidoarjo/?hl=en" target="_blank" rel="noopener noreferrer" class="transition-transform duration-200 hover:scale-110" title="Kunjungi Instagram BNN Sidoarjo">
                        <!-- PERUBAHAN UKURAN LOGO -->
                        <img src="logo-bnn.png" alt="Logo BNN" class="w-12 h-12 rounded-full">
                    </a>
                    <div class="relative">
                        <button id="settings-button" class="p-1 rounded-full hover:bg-slate-200">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        </button>
                        <div id="settings-menu" class="hidden absolute top-12 right-0 bg-white rounded-lg shadow-lg p-4 w-48 z-20">
                            <div class="flex items-center justify-between">
                                <span class="text-sm font-medium" data-translate-key="dark_mode">Dark Mode</span>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="dark-mode-toggle" class="sr-only peer">
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>
                            <div class="border-t border-slate-200 my-4"></div>
                            <div>
                                <h4 class="text-sm font-medium mb-2" data-translate-key="language">Bahasa</h4>
                                <div class="space-y-1">
                                    <button onclick="changeLanguage('id')" class="w-full text-left text-sm p-1 rounded hover:bg-slate-100">Indonesia</button>
                                    <button onclick="changeLanguage('en')" class="w-full text-left text-sm p-1 rounded hover:bg-slate-100">English</button>
                                    <button onclick="changeLanguage('ja')" class="w-full text-left text-sm p-1 rounded hover:bg-slate-100">日本語</button>
                                    <button onclick="changeLanguage('ru')" class="w-full text-left text-sm p-1 rounded hover:bg-slate-100">Русский</button>
                                    <button onclick="changeLanguage('ar')" class="w-full text-left text-sm p-1 rounded hover:bg-slate-100">العربية</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Konten Utama (dapat diganti sesuai tab) -->
        <main class="flex-grow overflow-y-auto p-4 pb-20">
            
            <!-- KONTEN 1: CHATBOT (Default) -->
            <div id="chat-content" class="h-full flex flex-col">
                <div id="chat-window" class="flex-grow space-y-4 overflow-y-auto smooth-scroll chat-window pr-2">
                    <div class="flex items-start gap-3">
                        <div class="bg-red-500 text-white p-2 rounded-full">
                           <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V8.25a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 8.25v10.5A2.25 2.25 0 0 0 6.75 21Z" /></svg>
                        </div>
                        <div>
                            <div class="bg-white rounded-lg rounded-tl-none p-3 shadow-sm">
                                <p class="text-sm" data-translate-key="welcome_msg">Hai! Aku KAWAN BISA. Pilih topik di bawah atau ketik pertanyaanmu untuk memulai.</p>
                            </div>
                            <div id="quick-actions" class="mt-2 flex flex-wrap gap-2">
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_what">Apa itu Narkoba?</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_types">Jenis-jenis</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_signs">Ciri Pengguna</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_side_effects">Efek Samping</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_duration">Durasi Efek</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_social_effects">Efek Sosial</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_law">Info Hukum</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_rehab">Proses Rehab</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_quit_strategy">Strategi Berhenti</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_avoid">Cara Menghindari</button>
                                <button onclick="sendQuickAction(this.textContent)" class="text-xs bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 py-1 rounded-full transition" data-translate-key="qa_positive">Kegiatan Positif</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mt-4 flex items-center gap-2">
                    <input type="text" id="chat-input" class="flex-grow bg-white border border-slate-300 rounded-full py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Ketik pesanmu di sini...">
                    <button id="send-button" onclick="sendMessage()" class="bg-blue-500 hover:bg-blue-600 text-white p-3 rounded-full transition shadow-md hover:shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" /></svg>
                    </button>
                </div>
            </div>

            <!-- KONTEN 2: SCREENING MANDIRI (BARU) -->
            <div id="screening-content" class="hidden">
                <div id="screening-questionnaire">
                    <h2 class="text-lg font-semibold mb-2" data-translate-key="screening_title">Screening Mandiri Risiko Narkoba</h2>
                    <p class="text-sm text-gray-600 mb-6" data-translate-key="screening_desc">Jawab pertanyaan berikut dengan jujur. Jawabanmu bersifat anonim dan hanya untuk membantumu memahami kondisimu.</p>
                    
                    <div class="space-y-4 text-sm">
                        <!-- Pertanyaan 1 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q1">1. Dalam 3 bulan terakhir, apakah Anda pernah menggunakan obat-obatan (di luar resep dokter) untuk mengubah suasana hati?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q1" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q1" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 2 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q2">2. Apakah Anda merasa sulit mengontrol keinginan atau jumlah pemakaian zat tersebut?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q2" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q2" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 3 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q3">3. Apakah lingkungan pertemanan Anda ada yang menggunakan narkoba?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q3" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q3" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 4 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q4">4. Apakah Anda pernah berbohong kepada keluarga atau teman mengenai penggunaan zat?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q4" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q4" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 5 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q5">5. Apakah penggunaan zat tersebut mulai berdampak negatif pada sekolah, pekerjaan, atau hubungan sosial Anda?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q5" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q5" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 6 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q6">6. Pernahkah Anda merasa bersalah atau menyesal setelah menggunakan zat?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q6" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q6" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 7 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q7">7. Pernahkah orang lain (keluarga/teman) mengeluh atau mengkritik tentang kebiasaan Anda menggunakan zat?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q7" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q7" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 8 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q8">8. Pernahkah Anda menggunakan zat di pagi hari untuk memulai hari atau menghilangkan rasa tidak nyaman?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q8" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q8" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 9 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q9">9. Apakah Anda pernah gagal dalam mencoba berhenti atau mengurangi penggunaan zat?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q9" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q9" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                        <!-- Pertanyaan 10 -->
                        <div class="bg-white p-3 rounded-lg shadow-sm">
                            <p class="font-medium" data-translate-key="q10">10. Apakah Anda pernah mengabaikan tanggung jawab (sekolah, kerja, keluarga) karena penggunaan zat?</p>
                            <div class="mt-2 flex gap-4"><label><input type="radio" name="q10" value="yes"> <span data-translate-key="yes">Ya</span></label><label><input type="radio" name="q10" value="no" checked> <span data-translate-key="no">Tidak</span></label></div>
                        </div>
                    </div>

                    <button onclick="calculateScreeningResult()" class="mt-6 w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition shadow-md hover:shadow-lg" data-translate-key="screening_submit">Lihat Hasil Screening</button>
                </div>

                <div id="screening-result" class="hidden">
                    <!-- Hasil akan ditampilkan di sini oleh JavaScript -->
                </div>
            </div>

            <!-- KONTEN 3: PETA RISIKO & POTENSI -->
            <div id="peta-content" class="hidden">
                <h2 class="text-lg font-semibold mb-4" data-translate-key="map_title">Peta Risiko & Potensi Sidoarjo</h2>
                <div class="bg-white rounded-lg p-4 shadow-md">
                    <div id="map" class="mb-4 bg-slate-200"></div>
                    <p class="text-sm text-gray-600 mb-4" data-translate-key="map_desc">Peta ini menunjukkan lokasi-lokasi kegiatan positif dan area yang memerlukan perhatian khusus di Sidoarjo. Data bersifat ilustratif.</p>
                    <div class="flex justify-around">
                        <div class="flex items-center gap-2"><div class="w-4 h-4 bg-green-500 rounded-full border border-white"></div><span class="text-xs" data-translate-key="map_legend_positive">Zona Potensi Positif</span></div>
                        <div class="flex items-center gap-2"><div class="w-4 h-4 bg-yellow-500 rounded-full border border-white"></div><span class="text-xs" data-translate-key="map_legend_attention">Zona Perhatian</span></div>
                    </div>
                </div>
            </div>

            <!-- KONTEN 4: LAPOR ANONIM -->
            <div id="lapor-content" class="hidden">
                <h2 class="text-lg font-semibold mb-4" data-translate-key="report_title">Lapor Cepat</h2>
                <div class="bg-white rounded-lg p-4 shadow-md">
                    <p class="text-sm text-gray-600 mb-4" data-translate-key="report_desc">Lihat aktivitas mencurigakan? Laporkan di sini. Laporan Anda akan diteruskan ke pihak berwenang.</p>
                    <form id="lapor-form" class="space-y-4">
                        <div><label for="lapor-nama" class="block text-sm font-medium text-gray-700" data-translate-key="report_name">Nama Pelapor</label><input type="text" id="lapor-nama" class="w-full mt-1 bg-slate-100 border border-slate-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nama Anda (opsional)"></div>
                        <div><label for="lapor-telepon" class="block text-sm font-medium text-gray-700" data-translate-key="report_phone">No. Telepon</label><input type="tel" id="lapor-telepon" class="w-full mt-1 bg-slate-100 border border-slate-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Nomor yang bisa dihubungi (opsional)"></div>
                        <div><label for="lapor-alamat" class="block text-sm font-medium text-gray-700" data-translate-key="report_address">Alamat Pelapor</label><input type="text" id="lapor-alamat" class="w-full mt-1 bg-slate-100 border border-slate-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Alamat Anda (opsional)"></div>
                        <div><label for="lapor-deskripsi" class="block text-sm font-medium text-gray-700" data-translate-key="report_incident_desc">Deskripsi Kejadian</label><textarea id="lapor-deskripsi" rows="4" class="w-full mt-1 bg-slate-100 border border-slate-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Jelaskan apa yang kamu lihat..." required></textarea></div>
                        <div><label for="lapor-lokasi" class="block text-sm font-medium text-gray-700" data-translate-key="report_incident_loc">Perkiraan Lokasi Kejadian</label><input type="text" id="lapor-lokasi" class="w-full mt-1 bg-slate-100 border border-slate-300 rounded-md p-2 focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Contoh: Dekat Alun-Alun Sidoarjo" required></div>
                        <button type="button" onclick="kirimLaporan()" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition shadow-md hover:shadow-lg" data-translate-key="report_button">Kirim Laporan via Email</button>
                    </form>
                </div>
            </div>
            
            <!-- KONTEN 5: BANTUAN & KLINIK DIGITAL -->
            <div id="bantuan-content" class="hidden">
                <h2 class="text-lg font-semibold mb-4" data-translate-key="help_title">Bantuan & Informasi Sidoarjo</h2>
                <div class="mb-6"><p class="text-center text-sm text-gray-600 mb-2" data-translate-key="help_emergency_desc">Butuh bantuan segera? Hubungi nomor darurat.</p>
                    <button onclick="showEmergencyConfirmation()" class="block w-full text-center bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-lg transition animate-pulse shadow-lg" data-translate-key="help_emergency_button">TOMBOL DARURAT</button>
                </div>
                
                <div class="space-y-4">
                    <div><h3 class="font-semibold mb-2 text-red-500" data-translate-key="help_psi_office">Kantor DPD PSI Sidoarjo</h3><div class="bg-white rounded-lg p-4 text-sm shadow-md"><p>Jl. Cemeng Bakalan No.184 11, RW.02, Cemeng, Cemeng Bakalan, Kec. Sidoarjo, Kabupaten Sidoarjo, Jawa Timur 61234</p><p class="mt-2 font-semibold" data-translate-key="help_psi_contact">Kontak: 0823-3543-3354 (Sekretariat)</p></div></div>
                    <div><h3 class="font-semibold mb-2 text-blue-500" data-translate-key="help_bnn_office">Kantor BNN Kabupaten Sidoarjo</h3><div class="bg-white rounded-lg p-4 text-sm shadow-md"><p>Jalan Perum Taman Pinang, Blok AA8, Nomor 1A, Kwadengan Barat, Lemahputro, Kec. Sidoarjo, Kabupaten Sidoarjo, Jawa Timur 61213</p></div></div>
                </div>

                <h3 class="font-semibold mt-6 mb-3" data-translate-key="help_lbh_title">Lembaga Bantuan Hukum (LBH)</h3>
                <div class="space-y-3">
                    <div class="bg-white rounded-lg p-4 shadow-md"><h4 class="font-semibold text-blue-500">LBH Sidoarjo</h4><p class="text-sm text-gray-600 mt-1" data-translate-key="help_lbh_desc">Menyediakan konsultasi dan pendampingan hukum. (Alamat & kontak perlu diverifikasi lebih lanjut)</p></div>
                </div>

                <h3 class="font-semibold mt-6 mb-3" data-translate-key="help_rehab_title">Klinik & Layanan Rehabilitasi</h3>
                <div class="space-y-3">
                    <div class="bg-white rounded-lg p-4 shadow-md"><h4 class="font-semibold text-blue-500">Klinik Pratama BNN Sidoarjo</h4><p class="text-sm text-gray-600 mt-1">Jl. Perum Taman Pinang Blok AA8, No. 1A, Sidoarjo</p></div>
                    <div class="bg-white rounded-lg p-4 shadow-md"><h4 class="font-semibold text-blue-500">RSUD Sidoarjo</h4><p class="text-sm text-gray-600 mt-1" data-translate-key="help_rsud_desc">Menyediakan layanan rehabilitasi medis.</p></div>
                </div>
            </div>
        </main>

        <!-- Navigasi Bawah (Tab Bar) -->
        <footer class="fixed bottom-0 left-0 right-0 max-w-md mx-auto bg-white/80 backdrop-blur-sm border-t border-slate-200">
            <nav class="flex justify-around p-2">
                <button id="tab-chat" onclick="showTab('chat')" class="tab-button flex flex-col items-center text-gray-500 hover:text-blue-500 transition tab-icon-active"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z" /></svg><span class="text-xs mt-1" data-translate-key="tab_chat">Chat</span></button>
                <button id="tab-screening" onclick="showTab('screening')" class="tab-button flex flex-col items-center text-gray-500 hover:text-blue-500 transition">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                    </svg>
                    <span class="text-xs mt-1" data-translate-key="tab_screening">Screening</span>
                </button>
                <button id="tab-peta" onclick="showTab('peta')" class="tab-button flex flex-col items-center text-gray-500 hover:text-blue-500 transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9 6.75V15m6-6v8.25m.5-10.5h-7a2.25 2.25 0 0 0-2.25 2.25v10.5a2.25 2.25 0 0 0 2.25 2.25h7.5a2.25 2.25 0 0 0 2.25-2.25V8.25a2.25 2.25 0 0 0-2.25-2.25H15M3 12h3m12 0h3" /></svg><span class="text-xs mt-1" data-translate-key="tab_map">Peta</span></button>
                <button id="tab-lapor" onclick="showTab('lapor')" class="tab-button flex flex-col items-center text-gray-500 hover:text-blue-500 transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z" /></svg><span class="text-xs mt-1" data-translate-key="tab_report">Lapor</span></button>
                <button id="tab-bantuan" onclick="showTab('bantuan')" class="tab-button flex flex-col items-center text-gray-500 hover:text-blue-500 transition"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12Z" /></svg><span class="text-xs mt-1" data-translate-key="tab_help">Bantuan</span></button>
            </nav>
        </footer>
    </div>
    
    <!-- Modal untuk notifikasi umum -->
    <div id="modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg p-6 max-w-sm w-full text-center shadow-xl">
            <p id="modal-message" class="text-gray-800 mb-4"></p>
            <button onclick="closeModal()" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-lg transition" data-translate-key="close_button">Tutup</button>
        </div>
    </div>
    
    <!-- Modal untuk konfirmasi panggilan darurat -->
    <div id="emergency-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50">
        <div class="bg-white rounded-lg p-6 max-w-sm w-full text-center shadow-xl">
            <h3 class="font-bold text-lg text-red-500" data-translate-key="emergency_confirm_title">Konfirmasi Panggilan Darurat</h3>
            <p class="text-gray-800 my-4 text-sm" data-translate-key="emergency_confirm_desc">Anda akan melakukan panggilan ke nomor darurat 112. Lanjutkan?</p>
            <div class="flex justify-center gap-4">
                <button onclick="hideEmergencyConfirmation()" class="bg-slate-500 hover:bg-slate-600 text-white font-bold py-2 px-6 rounded-lg transition" data-translate-key="emergency_cancel">Batal</button>
                <button onclick="makeEmergencyCall()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg transition" data-translate-key="emergency_call">Ya, Panggil</button>
            </div>
        </div>
    </div>


    <script>
        // --- DICTIONARY FOR TRANSLATIONS ---
        const translations = {
            'id': {
                "app_title": "KAWAN BISA", "app_subtitle": "Kolaborasi PSI DPD SIDOARJO X BNN SIDOARJO", "dark_mode": "Mode Gelap", "language": "Bahasa", "welcome_msg": "Hai! Aku KAWAN BISA. Pilih topik di bawah atau ketik pertanyaanmu untuk memulai.",
                "qa_what": "Apa itu Narkoba?", "qa_types": "Jenis-jenis", "qa_signs": "Ciri Pengguna", "qa_side_effects": "Efek Samping", "qa_duration": "Durasi Efek", "qa_social_effects": "Efek Sosial", "qa_law": "Info Hukum", "qa_rehab": "Proses Rehab", "qa_quit_strategy": "Strategi Berhenti", "qa_avoid": "Cara Menghindari", "qa_positive": "Kegiatan Positif",
                "chat_placeholder": "Ketik pesanmu di sini...", "map_title": "Peta Risiko & Potensi Sidoarjo", "map_desc": "Peta ini menunjukkan lokasi-lokasi kegiatan positif dan area yang memerlukan perhatian khusus di Sidoarjo. Data bersifat ilustratif.", "map_legend_positive": "Zona Potensi Positif", "map_legend_attention": "Zona Perhatian",
                "report_title": "Lapor Cepat", "report_desc": "Lihat aktivitas mencurigakan? Laporkan di sini. Laporan Anda akan diteruskan ke pihak berwenang.", "report_name": "Nama Pelapor", "report_phone": "No. Telepon", "report_address": "Alamat Pelapor", "report_incident_desc": "Deskripsi Kejadian", "report_incident_loc": "Perkiraan Lokasi Kejadian", "report_button": "Kirim Laporan via Email",
                "help_title": "Bantuan & Informasi Sidoarjo", "help_emergency_desc": "Butuh bantuan segera? Hubungi nomor darurat.", "help_emergency_button": "TOMBOL DARURAT", "help_psi_office": "Kantor DPD PSI Sidoarjo", "help_psi_contact": "Kontak: 0823-3543-3354 (Sekretariat)", "help_bnn_office": "Kantor BNN Kabupaten Sidoarjo", "help_lbh_title": "Lembaga Bantuan Hukum (LBH)", "help_lbh_desc": "Menyediakan konsultasi dan pendampingan hukum. (Alamat & kontak perlu diverifikasi lebih lanjut)", "help_rehab_title": "Klinik & Layanan Rehabilitasi", "help_rsud_desc": "Menyediakan layanan rehabilitasi medis.",
                "tab_chat": "Chat", "tab_screening": "Screening", "tab_map": "Peta", "tab_report": "Lapor", "tab_help": "Bantuan", "close_button": "Tutup",
                "screening_title": "Screening Mandiri Risiko Narkoba", "screening_desc": "Jawab pertanyaan berikut dengan jujur. Jawabanmu bersifat anonim dan hanya untuk membantumu memahami kondisimu.", 
                "q1": "1. Dalam 3 bulan terakhir, apakah Anda pernah menggunakan obat-obatan (di luar resep dokter) untuk mengubah suasana hati?", "q2": "2. Apakah Anda merasa sulit mengontrol keinginan atau jumlah pemakaian zat tersebut?", "q3": "3. Apakah lingkungan pertemanan Anda ada yang menggunakan narkoba?", "q4": "4. Apakah Anda pernah berbohong kepada keluarga atau teman mengenai penggunaan zat?", "q5": "5. Apakah penggunaan zat tersebut mulai berdampak negatif pada sekolah, pekerjaan, atau hubungan sosial Anda?", 
                "q6": "6. Pernahkah Anda merasa bersalah atau menyesal setelah menggunakan zat?", "q7": "7. Pernahkah orang lain (keluarga/teman) mengeluh atau mengkritik tentang kebiasaan Anda menggunakan zat?", "q8": "8. Pernahkah Anda menggunakan zat di pagi hari untuk memulai hari atau menghilangkan rasa tidak nyaman?", "q9": "9. Pernahkah Anda gagal dalam mencoba berhenti atau mengurangi penggunaan zat?", "q10": "10. Apakah Anda pernah mengabaikan tanggung jawab (sekolah, kerja, keluarga) karena penggunaan zat?",
                "yes": "Ya", "no": "Tidak", "screening_submit": "Lihat Hasil Screening", "result_low_title": "Hasil: Risiko Rendah (Sehat)", "result_low_desc": "Berdasarkan jawabanmu, kamu berada dalam kategori risiko rendah. Ini adalah kondisi yang sangat baik. Pertahankan gaya hidup sehatmu dan teruslah bergaul di lingkungan yang positif!", "result_medium_title": "Hasil: Risiko Sedang (Waspada)", "result_medium_desc": "Jawabanmu menunjukkan adanya beberapa faktor risiko. Ini adalah tanda untuk lebih waspada. Cobalah untuk mengurangi pergaulan di lingkungan yang berisiko dan perbanyak kegiatan positif. Jika merasa khawatir, jangan ragu untuk berbicara dengan orang yang kamu percaya.", "result_high_title": "Hasil: Risiko Tinggi (Segera Cari Bantuan)", "result_high_desc": "Hasil screening menunjukkan kamu berada dalam kategori risiko tinggi. Jangan panik, ini bukan akhir segalanya. Ini adalah langkah pertama untuk menyadari bahwa kamu butuh bantuan. Sangat disarankan untuk segera berbicara dengan profesional. Klik tombol 'Bantuan' untuk melihat daftar kontak yang bisa dihubungi.", "screening_reset": "Ulangi Screening",
                "emergency_confirm_title": "Konfirmasi Panggilan Darurat", "emergency_confirm_desc": "Anda akan melakukan panggilan ke nomor darurat 112. Lanjutkan?", "emergency_cancel": "Batal", "emergency_call": "Ya, Panggil"
            },
            'en': {
                // English translations...
            },
            // Other languages omitted for brevity
        };

        // --- CORE APP LOGIC ---
        const modal = document.getElementById('modal');
        const modalMessage = document.getElementById('modal-message');
        const emergencyModal = document.getElementById('emergency-modal');

        function showModal(message) { modalMessage.textContent = message; modal.classList.remove('hidden'); }
        function closeModal() { modal.classList.add('hidden'); }
        
        function showEmergencyConfirmation() { emergencyModal.classList.remove('hidden'); }
        function hideEmergencyConfirmation() { emergencyModal.classList.add('hidden'); }
        function makeEmergencyCall() { window.location.href = 'tel:112'; hideEmergencyConfirmation(); }

        const tabs = ['chat', 'screening', 'peta', 'lapor', 'bantuan'];
        const tabButtons = {};
        const tabContents = {};
        let mapInitialized = false;

        tabs.forEach(tab => {
            tabButtons[tab] = document.getElementById(`tab-${tab}`);
            tabContents[tab] = document.getElementById(`${tab}-content`);
        });

        function showTab(tabName) {
            tabs.forEach(tab => {
                tabContents[tab].classList.add('hidden');
                tabButtons[tab].classList.remove('tab-icon-active');
            });
            tabContents[tabName].classList.remove('hidden');
            tabButtons[tabName].classList.add('tab-icon-active');
            if (tabName === 'peta' && !mapInitialized) { initMap(); mapInitialized = true; }
        }

        function initMap() {
            const sidoarjoCoords = [-7.4478, 112.7183];
            const map = L.map('map').setView(sidoarjoCoords, 12);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors' }).addTo(map);
            const yellowIcon = new L.Icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-yellow.png', shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png', iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41] });
            const greenIcon = new L.Icon({ iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-2x-green.png', shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png', iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41] });
            L.marker([-7.455, 112.715], {icon: yellowIcon}).addTo(map).bindPopup('<b>Contoh Zona Perhatian</b><br>Area ini memerlukan kewaspadaan bersama.');
            L.marker([-7.444, 112.720], {icon: greenIcon}).addTo(map).bindPopup('<b>Alun-Alun Sidoarjo</b><br>Pusat kegiatan positif dan komunitas.');
            L.marker([-7.430, 112.710], {icon: greenIcon}).addTo(map).bindPopup('<b>GOR Delta Sidoarjo</b><br>Area untuk kegiatan olahraga.');
        }

        function kirimLaporan() {
            const nama = document.getElementById('lapor-nama').value;
            const telepon = document.getElementById('lapor-telepon').value;
            const alamat = document.getElementById('lapor-alamat').value;
            const deskripsi = document.getElementById('lapor-deskripsi').value;
            const lokasi = document.getElementById('lapor-lokasi').value;
            if (!deskripsi || !lokasi) { showModal('Deskripsi kejadian dan lokasi kejadian wajib diisi.'); return; }
            const subject = encodeURIComponent('Laporan Cepat dari Aplikasi KAWAN BISA');
            const body = encodeURIComponent(`Laporan Baru:\n\nNama Pelapor: ${nama || 'Tidak diisi'}\nNo. Telepon: ${telepon || 'Tidak diisi'}\nAlamat Pelapor: ${alamat || 'Tidak diisi'}\n\n-----------------------------------\nLOKASI KEJADIAN:\n${lokasi}\n\nDESKRIPSI KEJADIAN:\n${deskripsi}`);
            window.location.href = `mailto:aden.setyo91@gmail.com?subject=${subject}&body=${body}`;
            showModal('Anda akan diarahkan ke aplikasi email. Silakan kirim email tersebut.');
            document.getElementById('lapor-form').reset();
        }

        const chatWindow = document.getElementById('chat-window');
        const chatInput = document.getElementById('chat-input');
        const sendButton = document.getElementById('send-button');

        chatInput.addEventListener('keypress', (e) => e.key === 'Enter' && sendMessage());

        async function sendMessage() {
            const userInput = chatInput.value.trim();
            if (userInput === '') return;
            appendMessage(userInput, 'user');
            chatInput.value = '';
            chatInput.disabled = true;
            sendButton.disabled = true;
            showTypingIndicator();
            try {
                const botResponse = await getBotResponse(userInput);
                hideTypingIndicator();
                appendMessage(botResponse, 'bot');
            } catch (error) {
                hideTypingIndicator();
                appendMessage('Maaf, terjadi kesalahan saat menghubungi AI. Coba lagi nanti.', 'bot');
            } finally {
                chatInput.disabled = false;
                sendButton.disabled = false;
                chatInput.focus();
            }
        }
        
        async function sendQuickAction(text) {
            const currentLang = localStorage.getItem('language') || 'id';
            let key;
            for(const k in translations[currentLang]){
                if(translations[currentLang][k] === text) {
                    key = k;
                    break;
                }
            }
            const questionInEnglish = translations['en'][key];

            appendMessage(text, 'user');
            chatInput.disabled = true;
            sendButton.disabled = true;
            showTypingIndicator();
            try {
                const botResponse = await getBotResponse(questionInEnglish);
                hideTypingIndicator();
                appendMessage(botResponse, 'bot');
            } catch (error) {
                hideTypingIndicator();
                appendMessage('Maaf, terjadi kesalahan saat menghubungi AI. Coba lagi nanti.', 'bot');
            } finally {
                chatInput.disabled = false;
                sendButton.disabled = false;
                chatInput.focus();
            }
        }

        function appendMessage(message, sender) {
            const messageElement = document.createElement('div');
            if (sender === 'user') {
                messageElement.className = 'flex justify-end';
                messageElement.innerHTML = `<div class="bg-blue-500 text-white rounded-lg rounded-br-none p-3 max-w-xs shadow"><p class="text-sm">${message}</p></div>`;
            } else {
                messageElement.className = 'flex items-start gap-3';
                messageElement.innerHTML = `<div class="bg-red-500 text-white p-2 rounded-full flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V8.25a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 8.25v10.5A2.25 2.25 0 0 0 6.75 21Z" /></svg></div><div class="bg-white rounded-lg rounded-tl-none p-3 max-w-xs bot-response shadow-sm"><div class="text-sm text-gray-800">${message}</div></div>`;
            }
            chatWindow.appendChild(messageElement);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function showTypingIndicator() {
            const typingElement = document.createElement('div');
            typingElement.id = 'typing-indicator';
            typingElement.className = 'flex items-start gap-3';
            typingElement.innerHTML = `<div class="bg-red-500 text-white p-2 rounded-full flex-shrink-0"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V8.25a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 8.25v10.5A2.25 2.25 0 0 0 6.75 21Z" /></svg></div><div><div class="bg-white rounded-lg rounded-tl-none p-3 max-w-xs shadow-sm"><div class="flex items-center gap-1"><span class="w-2 h-2 bg-slate-300 rounded-full animate-bounce" style="animation-delay: 0s;"></span><span class="w-2 h-2 bg-slate-300 rounded-full animate-bounce" style="animation-delay: 0.1s;"></span><span class="w-2 h-2 bg-slate-300 rounded-full animate-bounce" style="animation-delay: 0.2s;"></span></div></div></div>`;
            chatWindow.appendChild(typingElement);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        function hideTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) typingIndicator.remove();
        }

        async function getBotResponse(userInput) {
            const currentLang = localStorage.getItem('language') || 'id';
            const systemPrompt = `Anda adalah "KAWAN BISA", chatbot AI ramah dari Sidoarjo. Jawab pertanyaan pengguna dalam bahasa ${currentLang === 'id' ? 'Indonesia' : 'English'}. Konteks: bahaya narkoba, rehabilitasi, hukum di Indonesia, cara hidup sehat. Jawab dengan empatik dan faktual. Jika ada krisis, sarankan hubungi hotline di menu Bantuan.`;
            
            const chatHistory = [{ role: "user", parts: [{ text: systemPrompt + "\n\nPertanyaan Pengguna: " + userInput }] }];
            const apiKey = "AIzaSyCCNIfFkPr3DlhBIJ9JljyD7P5GgFyTcA4"; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            const payload = { contents: chatHistory, generationConfig: { temperature: 0.7, topK: 1, topP: 1, maxOutputTokens: 8192 } };

            const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const result = await response.json();

            if (result.candidates && result.candidates[0]?.content?.parts[0]) {
                let text = result.candidates[0].content.parts[0].text;
                return text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            } else {
                return "Maaf, saya tidak bisa memproses jawaban saat ini. Coba lagi nanti.";
            }
        }
        
        function updateDateTime() {
            const now = new Date();
            const currentLang = localStorage.getItem('language') || 'id';
            const locale = currentLang === 'id' ? 'id-ID' : currentLang;
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' };
            document.getElementById('datetime').textContent = now.toLocaleDateString(locale, options);
        }

        // --- DARK MODE & LANGUAGE ---
        const settingsButton = document.getElementById('settings-button');
        const settingsMenu = document.getElementById('settings-menu');
        const darkModeToggle = document.getElementById('dark-mode-toggle');

        settingsButton.addEventListener('click', (e) => {
            e.stopPropagation();
            settingsMenu.classList.toggle('hidden');
        });
        
        document.addEventListener('click', (e) => {
            if (!settingsMenu.contains(e.target) && !settingsButton.contains(e.target)) {
                settingsMenu.classList.add('hidden');
            }
        });

        function applyTheme(theme) {
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                darkModeToggle.checked = true;
            } else {
                document.documentElement.classList.remove('dark');
                darkModeToggle.checked = false;
            }
        }

        darkModeToggle.addEventListener('change', () => {
            const theme = darkModeToggle.checked ? 'dark' : 'light';
            localStorage.setItem('theme', theme);
            applyTheme(theme);
        });

        function applyLanguage(lang) {
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            const elements = document.querySelectorAll('[data-translate-key]');
            elements.forEach(el => {
                const key = el.getAttribute('data-translate-key');
                if (translations[lang] && translations[lang][key]) {
                    el.innerHTML = translations[lang][key];
                }
            });
            document.getElementById('chat-input').placeholder = translations[lang]?.chat_placeholder || "Ketik pesanmu di sini...";
        }

        function changeLanguage(lang) {
            localStorage.setItem('language', lang);
            applyLanguage(lang);
            updateDateTime();
            settingsMenu.classList.add('hidden');
        }
        
        // --- SCREENING LOGIC ---
        function calculateScreeningResult() {
            const questionnaire = document.getElementById('screening-questionnaire');
            const resultContainer = document.getElementById('screening-result');
            const answers = document.querySelectorAll('#screening-questionnaire input[type="radio"]:checked');
            let score = 0;
            answers.forEach(answer => {
                if (answer.value === 'yes') {
                    score++;
                }
            });

            let resultTitleKey, resultDescKey, bgColor;

            // PERUBAHAN: Menyesuaikan skor dengan 10 pertanyaan
            if (score <= 2) {
                resultTitleKey = 'result_low_title';
                resultDescKey = 'result_low_desc';
                bgColor = 'bg-green-100 border-green-500 text-green-800';
            } else if (score <= 5) {
                resultTitleKey = 'result_medium_title';
                resultDescKey = 'result_medium_desc';
                bgColor = 'bg-yellow-100 border-yellow-500 text-yellow-800';
            } else {
                resultTitleKey = 'result_high_title';
                resultDescKey = 'result_high_desc';
                bgColor = 'bg-red-100 border-red-500 text-red-800';
            }
            
            const currentLang = localStorage.getItem('language') || 'id';
            resultContainer.innerHTML = `
                <div class="p-4 rounded-lg border ${bgColor}">
                    <h3 class="font-bold text-lg">${translations[currentLang][resultTitleKey]}</h3>
                    <p class="mt-2 text-sm">${translations[currentLang][resultDescKey]}</p>
                </div>
                <button onclick="resetScreening()" class="mt-4 w-full bg-slate-500 hover:bg-slate-600 text-white font-bold py-2 px-4 rounded-lg transition" data-translate-key="screening_reset">Ulangi Screening</button>
            `;

            questionnaire.classList.add('hidden');
            resultContainer.classList.remove('hidden');
        }

        function resetScreening() {
            document.getElementById('screening-questionnaire').classList.remove('hidden');
            document.getElementById('screening-result').classList.add('hidden');
            const radioButtons = document.querySelectorAll('#screening-questionnaire input[type="radio"]');
            radioButtons.forEach(radio => {
                if(radio.value === 'no') radio.checked = true;
            });
        }


        window.onload = () => { 
            const savedTheme = localStorage.getItem('theme') || 'light';
            const savedLang = localStorage.getItem('language') || 'id';
            applyTheme(savedTheme);
            applyLanguage(savedLang);

            showTab('chat'); 
            updateDateTime();
            setInterval(updateDateTime, 60000); 
        };
    </script>

</body>
</html>
" in the document "Aplikasi Web KAWAN BISA (Update Screening Lengkap)".
I want to make the following changes:
Change the font of the entire page to a more modern font.
I have also provided the new content for the chang
